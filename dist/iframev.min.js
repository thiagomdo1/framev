(()=>{"use strict";function n(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}const e=function(){function e(){var n=this;!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.prefix="__iframev__",this.subscriptions=[],this.isTop=window.self===window.top,window.addEventListener("message",(function(e){var t=e.data,i=new RegExp(n.prefix,"i");if(!t||"string"!=typeof t||-1===t.search(i))return null;var r=JSON.parse(t.replace(n.prefix,"")),s=r.event,o=r.message;n.isTop&&n.emit(s,o),n.subscriptions.forEach((function(n){if("function"!=typeof n.func)return null;if(s===n.event)return n.func(o),null;var e=n.event,t=e.replace("*",".*");t+="*"!==e[e.length-1]?"$":"";var i=new RegExp(t);s.search(i)>-1&&n.func(o)}))}))}var t,i;return t=e,(i=[{key:"emit",value:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!n||"string"!=typeof n)return null;var t={event:"".concat(this.prefix).concat(n)};e&&(t.message=e);var i=JSON.stringify(t),r=function(){if(!window.top)return null;window.top.postMessage(i)},s=function(){if(!window.frames)return null;for(var n=0;n<window.frames.length;n++){var e=window.frames[n].frameElement.contentWindow;if(!e)return null;e.postMessage(i)}};this.isTop?s():r()}},{key:"on",value:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!n||"string"!=typeof n)return null;var t=this.subscriptions.some((function(t){return t.event===n&&t.func===e}));t||this.subscriptions.push({event:n,func:e})}},{key:"off",value:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!n||"string"!=typeof n)return null;this.subscriptions=this.subscriptions.filter((function(t){return t.event!==n&&t.func!==e}))}}])&&n(t.prototype,i),e}();window.iframev=new e})();